<?xml version="1.0" encoding="windows-1250"?>

<!-- 20/11/2009 v elementu Smlouva pridan atribut KodPojistitele -->
<!-- 06.11.2014 IdentZaznamu rozsiren na 19 -->
<!-- 17.05.2017 oprava typu atributu ZObce a DoObce na string(1,36) -->

<xd:def
   xmlns:xd     = "http://www.syntea.cz/xdef/2.0"
   xd:name      = "L1_common"
   xd:classes   = "cz.syntea.xdef.util.L1protocol.L1A_ChkParser_dummy"
   xd:script    = "options ${L1#Options}"
   impl-version = "2013_09.1"
   impl-date    = "13.02.2014">

   <Adresa
      Ulice                    = "optional string(1,36);                                           onFalse setErr(4208)"
      CisloDomu                = "optional string(1,10);                                           onFalse setErr(4208)"
      Obec                     = "optional string(1,36);                                           onFalse setErr(4208)"
      Okres                    = "optional string(1,36);                                           onFalse setErr(4208)"
      Stat                     = "required tab('CC_Stat','KodStatu');                              onFalse setErr(4225); onAbsence setErr(4202)"
      PSC                      = "optional string(1,16);                                           onFalse setErr(4208)"
   />

   <Osoba                      xd:script = "finally {
                                  emptySubjHasAddr(4266,'Adresa');
                                  setDefault_ifEx('@StatPrislusnost','CZ','@RC');
                                  chkOpt_RC_ifEQ(4208,'@RC','@StatPrislusnost','CZ');
                                  chkOpt_RC_ifEQ(4208,'@RC','@StatPrislusnost','SK');
                                  chk_RC_DatNar_ifEQ(4224,'@RC','@DatumNarozeni','@StatPrislusnost','CZ');
                                  chk_RC_DatNar_ifEQ(4224,'@RC','@DatumNarozeni','@StatPrislusnost','SK');

                                  String elementName = from('name()');
                                  protocol(elementName,parseInt(getIdOsoba()));
                               }"

      Jmeno                    = "required string(1,24);                                           onFalse setErr(4208); onAbsence setErr(4202)"
      Prijmeni                 = "required string(1,36);                                           onFalse setErr(4208); onAbsence setErr(4202)"
      RC                       = "optional string(1,14);                                           onFalse setErr(4208)"
      DatumNarozeni            = "optional ${L1#DATE};           onTrue dateDavka(4221);           onFalse setErr(4208)"
      StatPrislusnost          = "optional tab('CC_Stat','KodStatu');                              onFalse setErr(4225)">

      <Adresa                  xd:script = "occurs 0..1; ref Adresa"/>
   </Osoba>

   <Subjekt                    xd:script="finally {
                                  subjekt_OsobaOrFirma(4314);
                                  setDefault_ifEx('@StatPrislusnost','CZ','@RC','@IC');
                                  chkOpt_RC_ifEQ(4208,'@RC','@StatPrislusnost','CZ');
                                  chkOpt_RC_ifEQ(4208,'@RC','@StatPrislusnost','SK');
                                  chkOpt_IC_ifEQ(4208,'@IC','@StatPrislusnost','CZ');
                                  chkOpt_IC_ifEQ(4208,'@IC','@StatPrislusnost','SK');
                                  chk_RC_DatNar_ifEQ(4224,'@RC','@DatumNarozeni','@StatPrislusnost','CZ');
                                  chk_RC_DatNar_ifEQ(4224,'@RC','@DatumNarozeni','@StatPrislusnost','SK');

                                  String elementName = from('name()');
                                  protocol(elementName,parseInt(getIdSubjekt()));
                               }"

      Zruseni                  = "required ${L1#BOOL_N}"
      Jmeno                    = "optional string(1,24);                                           onFalse setErr(4208)"
      Prijmeni                 = "optional string(1,36);                                           onFalse setErr(4208)"
      RC                       = "optional string(1,14);                                           onFalse setErr(4208)"
      DatumNarozeni            = "optional ${L1#DATE};           onTrue dateDavka(4221);           onFalse setErr(4208)"
      NazevFirmy               = "optional string(1,100);                                          onFalse setErr(4208)"
      IC                       = "optional string(1,12);                                           onFalse setErr(4208)"
      StatPrislusnost          = "optional tab('CC_Stat','KodStatu');                              onFalse setErr(4225)">

      <Adresa                  xd:script = "occurs 0..1; ref Adresa"/>
   </Subjekt>

   <Vozovka
      CisloSilnice             = "optional string(1,15);                                           onFalse setErr(4208)"
      ZObce                    = "optional string(1,36);                                           onFalse setErr(4208)"
      DoObce                   = "optional string(1,36);                                           onFalse setErr(4208)"
      Km                       = "optional dec(5,1);                                               onFalse setErr(4208)"
      Okres                    = "optional string(1,36);                                           onFalse setErr(4208)"
      Stat                     = "required tab('CC_Stat','KodStatu');                              onFalse setErr(4225); onAbsence setErr(4202)"
   />

   <GPS
      X                        = "required dec(9,5);                                               onFalse setErr(4208); onAbsence setErr(4202)"
      Y                        = "required dec(9,5);                                               onFalse setErr(4208); onAbsence setErr(4202)"
      SSyst                    = "required list('WGS84');                                          onFalse setErr(4225); onAbsence setErr(4202)"
   />

   <Misto                      xd:script = "finally {notEmptyMisto(4300); equal(4301,'Adresa[1]/@Stat','Vozovka[1]/@Stat');}">
      <GPS                     xd:script = "occurs 0..1; ref GPS"/>
      <Adresa                  xd:script = "occurs 0..1; ref Adresa"/>
      <Vozovka                 xd:script = "occurs 0..1; ref Vozovka"/>
      <xd:text>                optional string(1,512)</xd:text>
   </Misto>

   <Vozidlo                    xd:script = "finally {
                                  chkOpt_CisloTP_ifEQ(4208,'@CisloTP','@MPZ','CZ');

                                  String role = 'Ucastnene';
                                  if(toString(from('name(../..)')) == 'Smlouva') {
                                    role = 'Pojistene';
                                  }
                                  protocol(role,parseInt(getIdVozidlo()));
                               }"
      SPZ                      = "optional string(2,12);                                           onFalse setErr(4208)"
      MPZ                      = "required tab('CC_Stat','KodStatu');                              onFalse setErr(4225); onAbsence setErr(4202)"
      VIN                      = "optional string(1,26);                                           onFalse setErr(4208)"
      CisloTP                  = "optional string(1,12);                                           onFalse setErr(4208)"
      DruhVozidla              = "required fil0(2) AND tab('CC_DruhVozidla','KodDruhuVozidla');    onFalse setErr(4225); onAbsence setErr(4202)"
      ZnackaText               = "optional string(1,30);                                           onFalse setErr(4208)"
      ModelText                = "optional string(1,40);                                           onFalse setErr(4208)"
      KodModeluVozidla         = "optional tab('CC_ModelVozidla','KodModeluVozidla');              onFalse setErr(4225)"
      RokDoProvozu             = "optional datetime('yyyy');                                       onFalse setErr(4208)"
      BarvaText                = "optional string(1,20);                                           onFalse setErr(4208)"
   />

   <VozidloPS>
      <Vozidlo                 xd:script = "occurs 1;    ref Vozidlo;                                                  onAbsence setErr(4302)"/>
      <Vlastnik                xd:script = "occurs 0..1; ref Subjekt"/>
      <Provozovatel            xd:script = "occurs 0..1; ref Subjekt"/>
   </VozidloPS>

   <Smlouva                    xd:script = "finally {
                                 hasElement_if(4311,'@DruhPojisteni','HAV','Pojistnik');
                                 hasElement_if(4304,'@DruhPojisteni','HAV','VozidloPS');
                               }"

      KodPojistitele           = "optional tab('CC_Pojistitel','KodPojistitele');                  onFalse setErr(4225)"
      CisloSmlouvy             = "required string(3,35);                                           onFalse setErr(4208); onAbsence setErr(4202)"
      PoradiVozidla            = "required num(1,10);                                              onFalse setErr(4208); onAbsence setErr(4202)"
      DruhPojisteni            = "required list('POV','HAVPOV','HAV');                             onFalse setErr(4225); onAbsence setErr(4202)">

      <Pojistnik               xd:script = "occurs 0..1; ref Subjekt"/>
      <VozidloPS               xd:script = "occurs 0..1; ref VozidloPS"/>
   </Smlouva>

   <SkodaVozidla
      PlatnostDoTK             = "optional ${L1#DATE};                                             onFalse setErr(4208)"
      PocetKm                  = "optional int(0,9_999_999);                                       onFalse setErr(4208)"
      Kvadrant                 = "optional kvadrant();                                             onFalse setErr(4208)"
      Skoda                    = "optional int(1,99_999_999);                                      onFalse setErr(4208)"
      Mena                     = "optional tab('CC_Mena','KodMeny');                               onFalse setErr(4225); onAbsence { if(@Skoda) setText('CZK'); }"
      KodOpravny               = "optional tab('CC_Opravna','KodOpravny');                         onFalse setErr(4225)"
   />

   <VozidloPojistnika
      PoradiVozidlaSU          = "required int(1);                                                 onFalse setErr(4208); onAbsence setErr(4202)">
      <Smlouva                 xd:script = "occurs 1; ref Smlouva;                                                     onAbsence setErr(4303)"/>
      <Ridic                   xd:script = "occurs 0..1; ref Osoba"/>
      <SkodaVozidla            xd:script = "occurs 0..1; ref SkodaVozidla"/>
   </VozidloPojistnika>

   <VozidloUcastnika
      PoradiVozidlaSU          = "required int(2,999);                                             onFalse setErr(4208); onAbsence setErr(4202)"
      Zruseni                  = "required ${L1#BOOL_N}">

      <VozidloPS               xd:script = "occurs 1;    ref VozidloPS;                                                onAbsence setErr(4304)"/>
      <Ridic                   xd:script = "occurs 0..1; ref Osoba"/>
      <SkodaVozidla            xd:script = "occurs 0..1; ref SkodaVozidla"/>
   </VozidloUcastnika>

   <VozidloNepojistene
      PoradiVozidlaSU          = "required int(1);                                                 onFalse setErr(4208); onAbsence setErr(4202)">

      <VozidloPS               xd:script = "occurs 1;    ref VozidloPS;                                                onAbsence setErr(4304)"/>
      <Ridic                   xd:script = "occurs 0..1; ref Osoba"/>
      <SkodaVozidla            xd:script = "occurs 0..1; ref SkodaVozidla"/>
   </VozidloNepojistene>

   <VozidloNezjistene
      PoradiVozidlaSU          = "required int(1);                                                 onFalse setErr(4208); onAbsence setErr(4202)">
   </VozidloNezjistene>

   <RezervaXX
      Zruseni                  = "required ${L1#BOOL_N}"
      TypSkody                 = "required tab('CC_PodtypSkody','KodPodtypuSkody');                onFalse setErr(4225); onAbsence setErr(4202)"
      Zmena                    = "required dec(11,2);                                              onFalse setErr(4208); onAbsence setErr(4202)"
      Rezerva                  = "required dec(11,2); onTrue chk_dec_nonNegative(4208);            onFalse setErr(4208); onAbsence setErr(4202)"
      Mena                     = "required tab('CC_Mena','KodMeny');                               onFalse setErr(4225); onAbsence setText('CZK')"
   />

   <PlneniXX                   xd:script = "finally chk_TypMinusPlneni_Platba(4202,4204,'@TypMinusPlneni','@Platba')"
      Zruseni                  = "required ${L1#BOOL_N}"
      TypSkody                 = "required tab('CC_PodtypSkody','KodPodtypuSkody');                onFalse setErr(4225); onAbsence setErr(4202)"
      Platba                   = "required dec(11,2);                                              onFalse setErr(4208); onAbsence setErr(4202)"
      Vyplaceno                = "required dec(11,2); onTrue chk_dec_nonNegative(4208);            onFalse setErr(4208); onAbsence setErr(4202)"
      Mena                     = "required tab('CC_Mena','KodMeny');                               onFalse setErr(4225); onAbsence setText('CZK')"
      Ucet                     = "optional string(1,35);                                           onFalse setErr(4208)"
      TypMinusPlneni           = "optional tab('CC_TypMinusPlneni','KodTypMinusPlneni');           onFalse setErr(4208)"
   />

   <RegresXX
      Zruseni                  = "required ${L1#BOOL_N}"
      TypSkody                 = "required tab('CC_PodtypSkody','KodPodtypuSkody');                onFalse setErr(4225); onAbsence setErr(4202)"
      Castka                   = "required dec(11,2); onTrue chk_dec_nonNegative(4208);            onFalse setErr(4208); onAbsence setErr(4202)"
      Regres                   = "required dec(11,2); onTrue chk_dec_nonNegative(4208);            onFalse setErr(4208); onAbsence setErr(4202)"
      Mena                     = "required tab('CC_Mena','KodMeny');                               onFalse setErr(4225); onAbsence setText('CZK')"
      TypRegresu               = "required tab('CC_TypRegresu','KodTypRegresu');                   onFalse setErr(4225); onAbsence setErr(4202)"
   />

   <Indikator
      Zruseni                  = "required ${L1#BOOL_N}"
      Indikator                = "required tab('CC_Indikator','Indikator');                        onFalse setErr(4225); onAbsence setErr(4202)"
   />

   <SU
      IdentZaznamu             = "required string(1,19);                                           onFalse setErr(4208); onAbsence setErr(4202)"
      CisloSU                  = "required string(3,35);                                           onFalse setErr(1108); onAbsence setErr(1102)"
      DatumCasSU               = "required ${L1#DATETIME};           onTrue dateDavka(4221);       onFalse setErr(4208); onAbsence setErr(4202)"
      DatumCasDoSU             = "optional ${L1#DATETIME};           onTrue dateDavka(4221);       onFalse setErr(4208)"
      DatumCasOznameniSU       = "optional ${L1#DATETIME};           onTrue dateDavka(4221);       onFalse setErr(4208)"
      CJRelacePolicie          = "optional string(1,50);                                           onFalse setErr(4208)"
      StavSetreniPolicie       = "optional tab('CC_StavSetreniPolicie','KodStavuSetreniPolicie');  onFalse setErr(4225)"
      LikvidacniTitul          = "required list('HAV','POV');                                      onFalse setErr(4225); onAbsence setErr(4202)"
      RozhodnaUdalost          = "required list('A','N');                                          onFalse setErr(4225); onAbsence setErr(4202)"
      DatumUcinnosti           = "required ${L1#DATETIME};           onTrue dateDavka(4221);       onFalse setErr(4208); onAbsence setErr(4202)">

      <Misto                   xd:script = "occurs 1; ref Misto;                                                       onAbsence setErr(4306)"/>

      <xd:choice>
         <VozidloPojistnika    xd:script = "occurs 1; ref VozidloPojistnika;                                           onAbsence setErr(4307)"/>
         <VozidloNezjistene    xd:script = "occurs 1; ref VozidloNezjistene;                                           onAbsence setErr(4307)"/>
         <VozidloNepojistene   xd:script = "occurs 1; ref VozidloNepojistene;                                          onAbsence setErr(4307)"/>
      </xd:choice>

      <VozidloUcastnika        xd:script = "occurs 0..;  ref VozidloUcastnika "/>
      <Svedek                  xd:script = "occurs 0..;  ref Osoba"/>
      <Znalec                  xd:script = "occurs 0..;  ref Osoba"/>
      <Indikator               xd:script = "occurs 0..;  ref Indikator"/>
      <Likvidator              xd:script = "occurs 0..1; ref Osoba"/>
   </SU>

   <PU
      IdentZaznamu             = "required string(1,19);                                           onFalse setErr(4208); onAbsence setErr(4202)"
      CisloSU                  = "required string(3,35);                                           onFalse setErr(1108); onAbsence setErr(1102)"
      CisloPU                  = "required string(3,35);                                           onFalse setErr(1108); onAbsence setErr(1102)"
      DatumUcinnosti           = "required ${L1#DATETIME};           onTrue dateDavka(4221);       onFalse setErr(4208); onAbsence setErr(4202)">

      <Poskozeny               xd:script = "occurs 1;    ref Subjekt;                                                  onAbsence setErr(4308)"/>
      <Indikator               xd:script = "occurs 0..;  ref Indikator"/>
      <Likvidator              xd:script = "occurs 0..1; ref Osoba"/>
   </PU>

</xd:def>
